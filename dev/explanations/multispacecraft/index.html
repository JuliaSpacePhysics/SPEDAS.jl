<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Multi-spacecraft analysis methods ¬∑ SPEDAS.jl</title><meta name="title" content="Multi-spacecraft analysis methods ¬∑ SPEDAS.jl"/><meta property="og:title" content="Multi-spacecraft analysis methods ¬∑ SPEDAS.jl"/><meta property="twitter:title" content="Multi-spacecraft analysis methods ¬∑ SPEDAS.jl"/><meta name="description" content="Documentation for SPEDAS.jl."/><meta property="og:description" content="Documentation for SPEDAS.jl."/><meta property="twitter:description" content="Documentation for SPEDAS.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SPEDAS.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/01_getting-started/">Quickstart</a></li><li><a class="tocitem" href="../../tutorials/10_dynamic_power_spectra/">Dynamic power spectra calculations</a></li></ul></li><li><span class="tocitem">Explanation</span><ul><li><a class="tocitem" href="../data/">Data Formats and Retrieval</a></li><li><a class="tocitem" href="../data_model/">Data Model and Project Module</a></li><li><a class="tocitem" href="../coords/">Coordinate Systems and Transformations</a></li><li class="is-active"><a class="tocitem" href>Multi-spacecraft analysis methods</a><ul class="internal"><li><a class="tocitem" href="#Validation-with-PySPEDAS"><span>Validation with PySPEDAS</span></a></li><li><a class="tocitem" href="#Dataset-info"><span>Dataset info</span></a></li><li class="toplevel"><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../timeseries/">Time Series</a></li></ul></li><li><a class="tocitem" href="../../observatory/">Observatories</a></li><li><span class="tocitem">Validation</span><ul><li><a class="tocitem" href="../../validation/coords/">Compare Coordinate Transformations with IRBEM and PySPEDAS</a></li><li><a class="tocitem" href="../../validation/pyspedas/">Validation with PySPEDAS</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Explanation</a></li><li class="is-active"><a href>Multi-spacecraft analysis methods</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Multi-spacecraft analysis methods</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaSpacePhysics/SPEDAS.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaSpacePhysics/SPEDAS.jl/blob/main/docs/src/explanations/multispacecraft.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Multi-spacecraft-analysis-methods"><a class="docs-heading-anchor" href="#Multi-spacecraft-analysis-methods">Multi-spacecraft analysis methods</a><a id="Multi-spacecraft-analysis-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-spacecraft-analysis-methods" title="Permalink"></a></h1><p>This page demonstrates the use of multi-spacecraft analysis for MMS data. For more details about the package, see <a href="https://juliaspacephysics.github.io/MultiSpacecraftAnalysis.jl/dev/">MultiSpacecraftAnalysis.jl</a>.</p><pre><code class="language-julia hljs">using SPEDAS: tlingradest, setmeta
using Dates
using CDAWeb
using DimensionalData
using CairoMakie, SpacePhysicsMakie

t0 = DateTime(&quot;2016-12-09T09:02&quot;)
t1 = DateTime(&quot;2016-12-09T09:04&quot;)
fgm_datasets = ntuple(4) do probe
    get_data(&quot;MMS$(probe)_FGM_BRST_L2&quot;, t0, t1)
end

# Load data from CDF files into memory, MMS FGM data comes with magnitude
fields = ntuple(4) do probe
    DimArray(fgm_datasets[probe][&quot;mms$(probe)_fgm_b_gse_brst_l2&quot;])[X(1:3), Ti(t0..t1)]
end

tplot(fields)</code></pre><img src="bd9bd481.png" alt="Example block output"/><pre><code class="language-julia hljs">mec_datasets = ntuple(4) do probe
    get_data(&quot;MMS$(probe)_MEC_BRST_L2_EPHT89D&quot;, t0, t1)
end

positions = ntuple(4) do probe
    DimArray(mec_datasets[probe][&quot;mms$(probe)_mec_r_gse&quot;])[Ti(t0..t1)]
end

out = tlingradest(fields, positions)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr90">‚îå </span><span class="sgr38_5" style="color:#ff875f">3</span>√ó<span class="sgr38_5" style="color:#0087d7">15358</span> DimStack<span class="sgr90"> ‚îê</span>
<span class="sgr90">‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ dims ‚îê</span>
  <span class="sgr38_5" style="color:#ff875f">‚Üì Y</span> Sampled{Int64} <span class="sgr38_5" style="color:#ff875f">Base.OneTo(3)</span> <span class="sgr38_5" style="color:#808080">ForwardOrdered</span> <span class="sgr38_5" style="color:#808080">Regular</span> <span class="sgr38_5" style="color:#808080">Points</span>,
  <span class="sgr38_5" style="color:#0087d7">‚Üí Ti</span> Sampled{CommonDataFormat.TT2000} <span class="sgr38_5" style="color:#0087d7">[2016-12-09T09:02:00.011, ‚Ä¶, 2016-12-09T09:03:59.989]</span> <span class="sgr38_5" style="color:#808080">ForwardOrdered</span> <span class="sgr38_5" style="color:#808080">Irregular</span> <span class="sgr38_5" style="color:#808080">Points</span>
<span class="sgr90">‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ layers ‚î§</span>
<span class="sgr38_5" style="color:#00afaf">  :Rbary</span><span class="sgr90"> eltype: </span>Float64<span class="sgr90"> dims: </span><span class="sgr38_5" style="color:#ff875f">Y</span>, <span class="sgr38_5" style="color:#0087d7">Ti</span><span class="sgr90"> size: </span><span class="sgr38_5" style="color:#ff875f">3</span>√ó<span class="sgr38_5" style="color:#0087d7">15358</span>
<span class="sgr38_5" style="color:#00afaf">  :Bbc  </span><span class="sgr90"> eltype: </span>Float64<span class="sgr90"> dims: </span><span class="sgr38_5" style="color:#ff875f">Y</span>, <span class="sgr38_5" style="color:#0087d7">Ti</span><span class="sgr90"> size: </span><span class="sgr38_5" style="color:#ff875f">3</span>√ó<span class="sgr38_5" style="color:#0087d7">15358</span>
<span class="sgr38_5" style="color:#00afaf">  :Bmag </span><span class="sgr90"> eltype: </span>Float64<span class="sgr90"> dims: </span><span class="sgr38_5" style="color:#0087d7">Ti</span><span class="sgr90"> size: </span><span class="sgr38_5" style="color:#0087d7">15358</span>
<span class="sgr38_5" style="color:#00afaf">  :LGBx </span><span class="sgr90"> eltype: </span>Float64<span class="sgr90"> dims: </span><span class="sgr38_5" style="color:#ff875f">Y</span>, <span class="sgr38_5" style="color:#0087d7">Ti</span><span class="sgr90"> size: </span><span class="sgr38_5" style="color:#ff875f">3</span>√ó<span class="sgr38_5" style="color:#0087d7">15358</span>
<span class="sgr38_5" style="color:#00afaf">  :LGBy </span><span class="sgr90"> eltype: </span>Float64<span class="sgr90"> dims: </span><span class="sgr38_5" style="color:#ff875f">Y</span>, <span class="sgr38_5" style="color:#0087d7">Ti</span><span class="sgr90"> size: </span><span class="sgr38_5" style="color:#ff875f">3</span>√ó<span class="sgr38_5" style="color:#0087d7">15358</span>
<span class="sgr38_5" style="color:#00afaf">  :LGBz </span><span class="sgr90"> eltype: </span>Float64<span class="sgr90"> dims: </span><span class="sgr38_5" style="color:#ff875f">Y</span>, <span class="sgr38_5" style="color:#0087d7">Ti</span><span class="sgr90"> size: </span><span class="sgr38_5" style="color:#ff875f">3</span>√ó<span class="sgr38_5" style="color:#0087d7">15358</span>
<span class="sgr38_5" style="color:#00afaf">  :div  </span><span class="sgr90"> eltype: </span>Float64<span class="sgr90"> dims: </span><span class="sgr38_5" style="color:#0087d7">Ti</span><span class="sgr90"> size: </span><span class="sgr38_5" style="color:#0087d7">15358</span>
<span class="sgr38_5" style="color:#00afaf">  :curl </span><span class="sgr90"> eltype: </span>Float64<span class="sgr90"> dims: </span><span class="sgr38_5" style="color:#ff875f">Y</span>, <span class="sgr38_5" style="color:#0087d7">Ti</span><span class="sgr90"> size: </span><span class="sgr38_5" style="color:#ff875f">3</span>√ó<span class="sgr38_5" style="color:#0087d7">15358</span>
<span class="sgr38_5" style="color:#00afaf">  :curv </span><span class="sgr90"> eltype: </span>Float64<span class="sgr90"> dims: </span><span class="sgr38_5" style="color:#ff875f">Y</span>, <span class="sgr38_5" style="color:#0087d7">Ti</span><span class="sgr90"> size: </span><span class="sgr38_5" style="color:#ff875f">3</span>√ó<span class="sgr38_5" style="color:#0087d7">15358</span>
<span class="sgr38_5" style="color:#00afaf">  :R_c  </span><span class="sgr90"> eltype: </span>Float64<span class="sgr90"> dims: </span><span class="sgr38_5" style="color:#0087d7">Ti</span><span class="sgr90"> size: </span><span class="sgr38_5" style="color:#0087d7">15358</span>
<span class="sgr90">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span></code></pre><pre><code class="language-julia hljs">using LinearAlgebra
using Unitful

unitify(x, unit) = x isa Quantity ? x : x * unit

&quot;&quot;&quot;
Calculate the parallel component of current density with respect to magnetic field, given `ùêÅ` and Curl of magnetic field vector `curlùêÅ`.
&quot;&quot;&quot;
function jparallel(ùêÅ, curlùêÅ)
    ùêÅ = unitify.(ùêÅ, u&quot;nT&quot;)
    curlùêÅ = unitify.(curlùêÅ, u&quot;nT/km&quot;)
    J_parallel = dot(curlùêÅ, ùêÅ) / norm(ùêÅ) / Unitful.Œº0
    return J_parallel |&gt; u&quot;nA/m^2&quot;
end

jparallel(B::AbstractMatrix, curlùêÅ::AbstractMatrix; dim = 2) = jparallel.(eachslice(B; dims = dim), eachslice(curlùêÅ; dims = dim))

jp = jparallel(out.Bbc, out.curl)
jp = setmeta(jp, ylabel = &quot;Jparallel\n(nA/m¬≤)&quot;)
tplot((out.Bbc, out.div, out.curl, out.curv, jp))</code></pre><img src="86393221.png" alt="Example block output"/><h2 id="Validation-with-PySPEDAS"><a class="docs-heading-anchor" href="#Validation-with-PySPEDAS">Validation with PySPEDAS</a><a id="Validation-with-PySPEDAS-1"></a><a class="docs-heading-anchor-permalink" href="#Validation-with-PySPEDAS" title="Permalink"></a></h2><pre><code class="language- hljs">using PySPEDAS
using PythonCall
using Unitful
using Test
@py import pyspedas.projects.mms: mec, fgm, curlometer, lingradest
trange = string.([t0, t1])
fgm_vars = @py fgm(probe=[1, 2, 3, 4], trange=trange, data_rate=&quot;brst&quot;, time_clip=true, varformat=&quot;*_gse_*&quot;)
mec_vars = @py mec(probe=[1, 2, 3, 4], trange=trange, data_rate=&quot;brst&quot;, time_clip=true, varformat=&quot;*_r_gse&quot;)
posits_py = [&quot;mms1_mec_r_gse&quot;, &quot;mms2_mec_r_gse&quot;, &quot;mms3_mec_r_gse&quot;, &quot;mms4_mec_r_gse&quot;]
fields_py = [&quot;mms1_fgm_b_gse_brst_l2&quot;, &quot;mms2_fgm_b_gse_brst_l2&quot;, &quot;mms3_fgm_b_gse_brst_l2&quot;, &quot;mms4_fgm_b_gse_brst_l2&quot;]
curlometer_vars = curlometer(fields=fields_py, positions=posits_py)
jp_py = PySPEDAS.get_data(&quot;jpar&quot;)

# Due to interpolation, pyspedas first and last values are NaN
@test (jp ./ u&quot;A/m^2&quot; .|&gt; NoUnits) ‚âà (jp_py[2:end-1]) atol=1e-5</code></pre><h3 id="Benchmark"><a class="docs-heading-anchor" href="#Benchmark">Benchmark</a><a id="Benchmark-1"></a><a class="docs-heading-anchor-permalink" href="#Benchmark" title="Permalink"></a></h3><pre><code class="language- hljs">using Chairmarks
@b tlingradest($fields, $positions), lingradest(fields=$fields_py, positions=$posits_py), curlometer(fields=$fields_py, positions=$posits_py)</code></pre><p>Julia is about 100 times faster than Python for similar workflows.</p><h2 id="Dataset-info"><a class="docs-heading-anchor" href="#Dataset-info">Dataset info</a><a id="Dataset-info-1"></a><a class="docs-heading-anchor-permalink" href="#Dataset-info" title="Permalink"></a></h2><pre><code class="language-julia hljs">fgm_datasets[1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr31">Dataset: [&quot;/home/runner/.cdaweb/data/MMS1_FGM_BRST_L2/mms1_fgm_brst_l2_20161209090054_v5.87.0.cdf&quot;, &quot;/home/runner/.cdaweb/data/MMS1_FGM_BRST_L2/mms1_fgm_brst_l2_20161209090304_v5.87.0.cdf&quot;]</span>
Group: mms1_fgm_brst_l2

<span class="sgr31">Data variables</span>
<span class="sgr32">  mms1_fgm_b_gse_brst_l2</span>   (4 √ó 32000)
    Datatype:    <span class="sgr1">Float32</span>
    Dimensions:  nothing √ó Epoch
    Attributes:
     FILLVAL              = <span class="sgr36">Float32[-1.0f31]</span>
     FIELDNAM             = <span class="sgr36">Magnetic field vector in GSE plus Btotal (128 S/s)</span>
     VALIDMAX             = <span class="sgr36">Float32[20000.0, 20000.0, 20000.0, 20000.0]</span>
     SI_CONVERSION        = <span class="sgr36">1.0e-9&gt;T</span>
     TENSOR_ORDER         = <span class="sgr36">Int32[1]</span>
     CATDESC              = <span class="sgr36">Magnetic field vector in Geocentric Solar Ecliptic (GSE) cartesian coordinates plus Btotal (128 S/s)</span>
     DISPLAY_TYPE         = <span class="sgr36">time_series</span>
     VALIDMIN             = <span class="sgr36">Float32[-20000.0, -20000.0, -20000.0, 0.0]</span>
     UNITS                = <span class="sgr36">nT</span>
     REPRESENTATION_1     = <span class="sgr36">represent_vec_tot</span>
     SCALETYP             = <span class="sgr36">linear</span>
     DEPEND_0             = <span class="sgr36">Epoch</span>
     LABL_PTR_1           = <span class="sgr36">CommonDataFormat.StaticString{10, UInt8}[&quot;Bx GSE    &quot;, &quot;By GSE    &quot;, &quot;Bz GSE    &quot;, &quot;Bt        &quot;]</span>
     COORDINATE_SYSTEM    = <span class="sgr36">GSE</span>
     FORMAT               = <span class="sgr36">E13.5</span>
     VAR_TYPE             = <span class="sgr36">data</span>

<span class="sgr32">  mms1_fgm_b_gsm_brst_l2</span>   (4 √ó 32000)
    Datatype:    <span class="sgr1">Float32</span>
    Dimensions:  nothing √ó Epoch
    Attributes:
     FILLVAL              = <span class="sgr36">Float32[-1.0f31]</span>
     FIELDNAM             = <span class="sgr36">Magnetic field vector in GSM plus Btotal (128 S/s)</span>
     VALIDMAX             = <span class="sgr36">Float32[20000.0, 20000.0, 20000.0, 20000.0]</span>
     SI_CONVERSION        = <span class="sgr36">1.0e-9&gt;T</span>
     TENSOR_ORDER         = <span class="sgr36">Int32[1]</span>
     CATDESC              = <span class="sgr36">Magnetic field vector in Geocentric Solar Magnetospheric (GSM) cartesian coordinates plus Btotal (128 S/s)</span>
     DISPLAY_TYPE         = <span class="sgr36">time_series</span>
     VALIDMIN             = <span class="sgr36">Float32[-20000.0, -20000.0, -20000.0, 0.0]</span>
     UNITS                = <span class="sgr36">nT</span>
     REPRESENTATION_1     = <span class="sgr36">represent_vec_tot</span>
     SCALETYP             = <span class="sgr36">linear</span>
     DEPEND_0             = <span class="sgr36">Epoch</span>
     LABL_PTR_1           = <span class="sgr36">CommonDataFormat.StaticString{11, UInt8}[&quot;Bx GSM     &quot;, &quot;By GSM     &quot;, &quot;Bz GSM     &quot;, &quot;Bt         &quot;]</span>
     COORDINATE_SYSTEM    = <span class="sgr36">GSM</span>
     FORMAT               = <span class="sgr36">E13.5</span>
     VAR_TYPE             = <span class="sgr36">data</span>

<span class="sgr32">  mms1_fgm_b_dmpa_brst_l2</span>   (4 √ó 32000)
    Datatype:    <span class="sgr1">Float32</span>
    Dimensions:  nothing √ó Epoch
    Attributes:
     FILLVAL              = <span class="sgr36">Float32[-1.0f31]</span>
     FIELDNAM             = <span class="sgr36">Magnetic field vector in DMPA plus Btotal (128 S/s)</span>
     VALIDMAX             = <span class="sgr36">Float32[20000.0, 20000.0, 20000.0, 20000.0]</span>
     SI_CONVERSION        = <span class="sgr36">1.0e-9&gt;T</span>
     TENSOR_ORDER         = <span class="sgr36">Int32[1]</span>
     CATDESC              = <span class="sgr36">Magnetic field vector in Despun MPA-aligned cartesian coordinates plus Btotal (128 S/s)</span>
     DISPLAY_TYPE         = <span class="sgr36">time_series</span>
     VALIDMIN             = <span class="sgr36">Float32[-20000.0, -20000.0, -20000.0, 0.0]</span>
     UNITS                = <span class="sgr36">nT</span>
     VAR_NOTES            = <span class="sgr36">During nominal operatins in the region of interest, DMPA is within 3 degrees of GSE.  </span>
     SCALETYP             = <span class="sgr36">linear</span>
     REPRESENTATION_1     = <span class="sgr36">represent_vec_tot</span>
     DEPEND_0             = <span class="sgr36">Epoch</span>
     LABL_PTR_1           = <span class="sgr36">CommonDataFormat.StaticString{10, UInt8}[&quot;Bx DMPA   &quot;, &quot;By DMPA   &quot;, &quot;Bz DMPA   &quot;, &quot;Bt        &quot;]</span>
     COORDINATE_SYSTEM    = <span class="sgr36">DMPA&gt;Despun Major Principal Axis</span>
     FORMAT               = <span class="sgr36">E13.5</span>
     VAR_TYPE             = <span class="sgr36">data</span>

<span class="sgr32">  mms1_fgm_b_bcs_brst_l2</span>   (4 √ó 32000)
    Datatype:    <span class="sgr1">Float32</span>
    Dimensions:  nothing √ó Epoch
    Attributes:
     FILLVAL              = <span class="sgr36">Float32[-1.0f31]</span>
     FIELDNAM             = <span class="sgr36">Magnetic field vector in BCS plus Btotal (128 S/s)</span>
     VALIDMAX             = <span class="sgr36">Float32[20000.0, 20000.0, 20000.0, 20000.0]</span>
     SI_CONVERSION        = <span class="sgr36">1.0e-9&gt;T</span>
     TENSOR_ORDER         = <span class="sgr36">Int32[1]</span>
     CATDESC              = <span class="sgr36">Magnetic field vector in Body Coordinate System cartesian coordinates plus Btotal (128 S/s)</span>
     DISPLAY_TYPE         = <span class="sgr36">time_series</span>
     VALIDMIN             = <span class="sgr36">Float32[-20000.0, -20000.0, -20000.0, 0.0]</span>
     UNITS                = <span class="sgr36">nT</span>
     REPRESENTATION_1     = <span class="sgr36">represent_vec_tot</span>
     SCALETYP             = <span class="sgr36">linear</span>
     DEPEND_0             = <span class="sgr36">Epoch</span>
     LABL_PTR_1           = <span class="sgr36">CommonDataFormat.StaticString{10, UInt8}[&quot;Bx BCS    &quot;, &quot;By BCS    &quot;, &quot;Bz BCS    &quot;, &quot;Bt        &quot;]</span>
     COORDINATE_SYSTEM    = <span class="sgr36">BCS&gt;Body Coordinate System</span>
     FORMAT               = <span class="sgr36">E13.5</span>
     VAR_TYPE             = <span class="sgr36">data</span>

<span class="sgr32">  mms1_fgm_r_gse_brst_l2</span>   (4 √ó 17)
    Datatype:    <span class="sgr1">Float32</span>
    Dimensions:  nothing √ó Epoch_state
    Attributes:
     FILLVAL              = <span class="sgr36">Float32[-1.0f31]</span>
     FIELDNAM             = <span class="sgr36">mms1_fgm_r_gse_brst_l2</span>
     VALIDMAX             = <span class="sgr36">Float32[1.0f6]</span>
     SI_CONVERSION        = <span class="sgr36">1.0e3&gt;m</span>
     TENSOR_ORDER         = <span class="sgr36">Int32[1]</span>
     CATDESC              = <span class="sgr36">Definitive Position in GSE coordinates, 30 second</span>
     DISPLAY_TYPE         = <span class="sgr36">time_series</span>
     VALIDMIN             = <span class="sgr36">Float32[-1.0f6]</span>
     UNITS                = <span class="sgr36">km</span>
     REPRESENTATION_1     = <span class="sgr36">represent_vec_tot</span>
     SCALETYP             = <span class="sgr36">linear</span>
     DEPEND_0             = <span class="sgr36">Epoch_state</span>
     LABL_PTR_1           = <span class="sgr36">CommonDataFormat.StaticString{10, UInt8}[&quot;X GSE     &quot;, &quot;Y GSE     &quot;, &quot;Z GSE     &quot;, &quot;R         &quot;]</span>
     COORDINATE_SYSTEM    = <span class="sgr36">GSE</span>
     FORMAT               = <span class="sgr36">E12.2</span>
     VAR_TYPE             = <span class="sgr36">data</span>

<span class="sgr32">  mms1_fgm_r_gsm_brst_l2</span>   (4 √ó 17)
    Datatype:    <span class="sgr1">Float32</span>
    Dimensions:  nothing √ó Epoch_state
    Attributes:
     FILLVAL              = <span class="sgr36">Float32[-1.0f31]</span>
     FIELDNAM             = <span class="sgr36">mms1_fgm_r_gsm_brst_l2</span>
     VALIDMAX             = <span class="sgr36">Float32[1.0f6]</span>
     SI_CONVERSION        = <span class="sgr36">1.0e3&gt;m</span>
     TENSOR_ORDER         = <span class="sgr36">Int32[1]</span>
     CATDESC              = <span class="sgr36">Definitive Position in GSM coordinates, 30 second</span>
     DISPLAY_TYPE         = <span class="sgr36">time_series</span>
     VALIDMIN             = <span class="sgr36">Float32[-1.0f6]</span>
     UNITS                = <span class="sgr36">km</span>
     REPRESENTATION_1     = <span class="sgr36">represent_vec_tot</span>
     SCALETYP             = <span class="sgr36">linear</span>
     DEPEND_0             = <span class="sgr36">Epoch_state</span>
     LABL_PTR_1           = <span class="sgr36">CommonDataFormat.StaticString{10, UInt8}[&quot;X GSM     &quot;, &quot;Y GSM     &quot;, &quot;Z GSM     &quot;, &quot;R         &quot;]</span>
     COORDINATE_SYSTEM    = <span class="sgr36">GSM</span>
     FORMAT               = <span class="sgr36">E12.2</span>
     VAR_TYPE             = <span class="sgr36">data</span>

<span class="sgr31">Support variables: </span><span class="sgr1">Epoch, mms1_fgm_flag_brst_l2, Epoch_state, mms1_fgm_hirange_brst_l2, mms1_fgm_bdeltahalf_brst_l2, mms1_fgm_stemp_brst_l2, mms1_fgm_etemp_brst_l2, mms1_fgm_mode_brst_l2, mms1_fgm_rdeltahalf_brst_l2</span>
<span class="sgr31">Metadata variables: </span><span class="sgr1">label_b_gse, label_b_gsm, label_b_dmpa, label_b_bcs, label_r_gse, label_r_gsm, represent_vec_tot</span>
<span class="sgr31">Global attributes</span>
  Project              = <span class="sgr36">[&quot;STP&gt;Solar-Terrestrial Physics&quot;]</span>
  Source_name          = <span class="sgr36">[&quot;MMS1&gt;MMS Satellite Number 1&quot;]</span>
  Discipline           = <span class="sgr36">[&quot;Space Physics&gt;Magnetospheric Science&quot;]</span>
  Data_type            = <span class="sgr36">[&quot;brst_l2&quot;]</span>
  Descriptor           = <span class="sgr36">[&quot;FGM&gt;Flux Gate Magnetometer&quot;]</span>
  File_naming_convention = <span class="sgr36">[&quot;source_descriptor_datatype_yyyyMMddHHmmss&quot;]</span>
  Data_version         = <span class="sgr36">[&quot;5.87.0&quot;]</span>
  PI_name              = <span class="sgr36">[&quot;J. Burch, C. Russell, W. Magnus&quot;]</span>
  PI_affiliation       = <span class="sgr36">[&quot;SWRI, UCLA, IWF&quot;]</span>
  TEXT                 = <span class="sgr36">[&quot;The Fluxgate Magnetometers (FGM) on Magnetospheric Multiscale consist of a traditional Analog Fluxgate Magnetometer (AFG), and a Digital Fluxgate magnetometer (DFG). The dual magnetometers are operated as a single instrument providing a single intercalibrated data product. Range changes occur at different times on the two instruments so the gains checked each periapsis can be carried out unambiguously to apoapsis. Cross correlation of calibration parameters can separate causes of the any apparent calibration changes. Use of Electron Drift Instrument (EDI) to determine the field along the rotation axis allows accurate monitoring of the zero levels along the rotation axis.  Prior to launch the magnetometers were calibrated at the Technical University, Braunschweig, except for the AFG magnetometers on MMS3 and MMS4, which were calibrated at UCLA.  Both sets of sensors are operated for the entire MMS orbit, with slow survey (8 samples per second) outside of the Region of Interest (ROI), and fast survey (16 samples per second) inside the ROI. Within the ROI burst mode data (128 samples per second) are also acquired.  A detailed description of the MMS fluxgate magnetometers, including science objectives, instrument description, calibration, magnetic cleanliness program, and data flow can be found at http://link.springer.com/article/10.1007%2Fs11214-014-0057-3 (DOI 10.1007/s11214-014-0057-3).Additional information can also be found at http://www-spc.igpp.ucla.edu/ssc/mms (UCLA),and http://www.iwf.oeaw.ac.at (IWF, Graz).&quot;, &quot;For the purpose of creating a unified FGM Level2 data product, burst mode data is taken from DFG and survey mode data is taken from AFG.  Because AFG and DFG are cross-calibrated on an orbit-averaged basis, small differences in offset may be observed between Level2 burst and survey mode data.  Consequently, any differences are within the error of the measurement. Based on preliminary analysis of the data, the absolute error within the Region of Interest (ROI) is estimated to be no more than 0.1 nT in the spin-plane, 0.15 nT along the spin-axis and 0.2 nT in total magnitude.&quot;]</span>
  Instrument_type      = <span class="sgr36">[&quot;Magnetic Fields (space)&quot;]</span>
  Mission_group        = <span class="sgr36">[&quot;MMS&quot;]</span>
  Logical_source       = <span class="sgr36">[&quot;mms1_fgm_brst_l2&quot;]</span>
  Logical_file_id      = <span class="sgr36">[&quot;mms1_fgm_brst_l2_20161209090054_v5.87.0&quot;]</span>
  Logical_source_description = <span class="sgr36">[&quot;Level2 Flux Gate Magnetometer Burst DC Magnetic Field for MMS Satellite Number 1&quot;]</span>
  Time_resolution      = <span class="sgr36">[&quot;0.0078125 sec&quot;]</span>
  Rules_of_use         = <span class="sgr36">[&quot;See MMS Data Rights and Rules for Use https://lasp.colorado.edu/galaxy/display/mms/MMS+Data+Rights+and+Rules+for+Data+Use&quot;]</span>
  Generated_by         = <span class="sgr36">[&quot;UCLA&quot;]</span>
  Generation_date      = <span class="sgr36">[&quot;20170617&quot;]</span>
  Acknowledgement      = <span class="sgr36">Any[]</span>
  MODS                 = <span class="sgr36">[&quot;version X=5:  * Y-version number comes from cal file entries. \n              * Ensures there are 2 ephemeris points before/after data to enable proper spline.  \n              * Fix to depend_0 of rdeltahalf:  fixes bug when reading position data.\n              * L-vector for DMPA2GSE transformation is smoothed with a gaussian filter, instead \n                of using a single average value for the day.  This short-term filter avoids  \n                introduding artificial jumps at 00:00 UTC and removes 7-minute &#39;wobble&#39; after  \n                maneuvers in the GSE result.   \n              * Fixes error with DEFATT file selection found when choosing the \n                daily DEFATT files to be used in Phase 2.\n              * Fixed bug where reference Etemp was used for high range gain.  Now uses measured Etemp.\nversion X=4:  First version for public release of L2.\n              Renamed variables to conform with new MMS variable name guidelines \n              (obs_instr_paramName[_coordSys]_mode_level):  \n                Mag field parameters include &#39;b&#39; for paramName.  \n                Use &#39;r&#39; instead of &#39;pos&#39; for S/C position paramName.  \n                Eliminated &#39;rate&#39;, replaced with &#39;bdeltahalf&#39;.  Added &#39;rdeltahalf&#39;.\n                l1a_mode is now just &#39;mode&#39;.\nversion X=3:  fixed removal of overlap between modes.\n              fixed a bug that caused stemp and etemp to be empty.\nversion X=2:  flag parameter name corrected: was &#39;status&#39;\n                        added bits 4, 5, 6 to flag saturation on B1, B2, and B3, respectively\n                        added bit 7 to flag bad data at range changes\n              Added etemp and l1a_mode parameters.  \n              rate, hirange, and stemp parameters now comply with MMS CDF Guidlelines, e.g.\n              FILLVAL now defined for stemp and etemp, and is set to !values.f_nan\n              No longer use Var_Parents attribute in stemp -- see Parents instead\n              In this version, temperature-corrected gains are applied.  Reference temperatures are used when \n              stemp or etemp are set to FILLVAL. \n              Non-linearity correction is applied to high rage DFG data.\nversion X=1:  added &#39;flag&#39;, rate and hirange parameters (but &#39;flag&#39; is actually called &#39;status&#39;)&quot;]</span>
  ADID_ref             = <span class="sgr36">Any[]</span>
  LINK_TEXT            = <span class="sgr36">[&quot;MMS home page&quot;, &quot;SMART package home page&quot;, &quot;Science Data Center&quot;, &quot;FGM team home page&quot;, &quot;FGM team&quot;]</span>
  LINK_TITLE           = <span class="sgr36">[&quot;at GSFC&quot;, &quot;at SWRI&quot;, &quot;at LASP&quot;, &quot;at UCLA&quot;, &quot;at IWF&quot;]</span>
  HTTP_LINK            = <span class="sgr36">[&quot;http://mms.gsfc.nasa.gov/&quot;, &quot;http://mms.space.swri.edu/index.html&quot;, &quot;https://lasp.colorado.edu/mms/sdc&quot;, &quot;http://www-spc.igpp.ucla.edu/ssc/mms&quot;, &quot;http://www.iwf.oeaw.ac.at&quot;]</span>
  Parents              = <span class="sgr36">[&quot;CDF&gt;mms1_dfg_brst_l1a_20161209090054_v1.7.0&quot;, &quot;CDF&gt;mms1_fields_hk_l1b_10e_20161209_v0.5.0&quot;, &quot;MMS1_DEFATT_2016343_2016344.V00&quot;, &quot;MMS1_DEFEPH_2016343_2016344.V01&quot;, &quot;CDF&gt;mms1_dfg_lorangecal_l2pre_20100101_v12.87.0&quot;]</span>
</code></pre><h1 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h1><ul><li>https://github.com/spedas/mms-examples/blob/master/basic/Curlometer%20Technique.ipynb</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../coords/">¬´ Coordinate Systems and Transformations</a><a class="docs-footer-nextpage" href="../timeseries/">Time Series ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 13 February 2026 19:59">Friday 13 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
